SQL Exercise

Question 1:

SELECT count(*) 
FROM tbl_book AS t_b
INNER JOIN tbl_book_copies AS t_bc 
	ON t_b.bookId=t_bc.bookId 
INNER JOIN tbl_library_branch AS t_lb 
	ON t_bc.branchId=t_lb.branchId 
WHERE title='The Stand' 
	AND branchName='Fenwick Library'


Question 2:

SELECT t_lb.branchName, count(*) AS noOfCopies
FROM tbl_book AS t_b
INNER JOIN tbl_book_copies AS t_bc 
	ON t_b.bookId=t_bc.bookId 
INNER JOIN tbl_library_branch AS t_lb 
	ON t_bc.branchId=t_lb.branchId 
WHERE title='The Stand'
GROUP BY branchName
ORDER BY branchName ASC


Question 3:

SELECT DISTINCT name 
FROM tbl_borrower AS t_b
LEFT JOIN tbl_book_loans AS t_bl
	ON t_b.cardNo=t_bl.cardNo
WHERE bookId IS NULL
	OR (bookId IS NOT NULL AND dateIn IS NOT NULL)
ORDER BY name ASC


Question 4:

SELECT t_bk.title, t_bw.name, t_bw.address
FROM tbl_book_loans AS t_bl
INNER JOIN tbl_book AS t_bk
	ON t_bl.bookId=t_bk.bookId
INNER JOIN tbl_borrower AS t_bw
	ON t_bl.cardNo=t_bw.cardNo
INNER JOIN tbl_library_branch AS t_lb
	ON t_bl.branchId=t_lb.branchId
WHERE branchName='Loudoun Campus Library'
	AND dueDate=current_date()


Question 5:

SELECT branchName, count(*) AS noBooksLoanedOut
FROM tbl_library_branch AS t_lb
LEFT JOIN tbl_book_loans AS t_bl
	ON t_lb.branchId=t_bl.branchId
WHERE dateOut IS NOT NULL
	AND dateIn IS NULL
GROUP BY branchName
ORDER BY branchName ASC


Question 6:

SELECT name, address, count(*) AS noBooksCheckedOut
FROM tbl_book_loans AS t_bl
INNER JOIN tbl_borrower AS t_b
	ON t_bl.cardNo=t_b.cardNo
WHERE dateOut IS NOT NULL
	AND dateIn IS NULL
GROUP BY t_b.cardNo
	HAVING COUNT(t_b.cardNo) > 5
	
	
Question 7:

SELECT title, noOfCopies
FROM tbl_book AS t_bk
INNER JOIN tbl_book_authors AS t_ba
	ON t_bk.bookId=t_ba.bookId
INNER JOIN tbl_author AS t_a
	ON t_ba.authorId=t_a.authorId
INNER JOIN tbl_book_copies AS t_bc
	ON t_bk.bookId=t_bc.bookId
INNER JOIN tbl_library_branch AS t_lb
	ON t_bc.branchId=t_lb.branchId
WHERE authorName="Stephen King"
	AND t_lb.branchName="Ashburn Library"